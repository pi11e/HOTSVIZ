# HOTSVIZ
A project made to process Heroes of the Storm replays and visualize player statistics contained therein.

Preparations:
1. Install node.js including npm from here: https://nodejs.org/en/download/package-manager 
2. Verify by running npm -v in a command line of your choice - it should print the version string of npm.
3. Install mysql community server and MySQL workbench from here: https://dev.mysql.com/downloads/mysql/
4. Clone or download this repository, then run npm install via commandline in the root directory of this repository. This should evaluate the package.json file and install all listed dependencies.
5. Verify by running npm run dev - this should at least indicate a webserver has started successfully, even if some files required for stats visualization may be incorrect or missing.

Instructions:
1. In your replay folder, run the included convertToJSON.bat file (copy it there first). It will call heroes-decode (from https://github.com/HeroesToolChest) to convert replay files into JSON.
2. Next, point the data_path.cfg to the folder that contains your json replays (better not to do this directly in your live replay folder - perhaps copy them to a temp folder first, then point at that). 
3. Run the hotsdb.js script to populate a local mysql database with the replay data and generate a number of json files used to visualize this data. 
    ! Make sure to edit the database credentials at the top of the script to fit your user setup as configured when installing your mysql server.
4. Type npm run dev in the root directory of this repository again to launch a local webserver hosting index.html on localhost:1234 to bootstrap the visualization client (hosted on a simple HTML5 canvas via Chart.js).

In short:
To populate your own database, install a mysql server then configure and run hotsdb.js.

To build, make sure you have node.js and npm installed.

To resolve dependencies, execute
.\HOTSVIZ>npm install 

To run, execute
.\HOTSVIZ>npm run dev
then navigate to localhost:1234

# DIRECTORIES

- data: used to contain relevant configuration and visualization data. Configuration files are indicated as .cfg and will not change. json files will be regenerated by executing hotsdb.js. This is also where convertToJSON.bat lives, the commandline tool to convert .stormreplay to .json files.

- src: this is where relevant source files are stored, documented in more detail below. 

# FILES

- hotsdb.js // reads a directory of json files and stores each in a local mysql database (see reset / populatedatabase). alternatively, assumes an existing database and generates json datasets stored as local files
- hotsdata.js // parses local json files and turns them into datasets for consumption by Chart.js
- hotsviz.js // renders Chart.js charts on an HTML5 canvas, handling all of the configuration and visualization of data it pulls from hotsdata.js which acts as an interface.
- index.html // includes relevant scripts and defines the position of the HTML elements used for chart rendering 

# HACKS

- game hero / the hero taken for each replay to consider winrate is based on the hero played by the replay owner
- the heat map is based on the maps and heroes appearing in the "queryForRankedMaps" and "queryForRankedHeroes" results... if you want your own heroes played in ranked to appear correctly, these need to be generated first 
    (will automatically be the case when executing the hotsdb script in non-reset mode)